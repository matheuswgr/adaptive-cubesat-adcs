<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">

<xacro:macro name="dc_motor" params="motor_name parent_link child_link *origin *axis">
  <joint name="${motor_name}" type="continuous">
      <parent link="${parent_link}"/>
      <child link="${child_link}"/>
      <xacro:insert_block name="origin"/>
      <xacro:insert_block name="axis"/>
  </joint>
  <gazebo reference="${motor_name}">
    <provideFeedback>true</provideFeedback>
  </gazebo>
  <gazebo>
    <plugin name="${motor_name}_plugin" filename="libgazebo_ros_dc_motor.so">
      <motor_shaft_joint>${motor_name}</motor_shaft_joint>
      <motor_wrench_frame>${child_link}</motor_wrench_frame>
      <command_topic>${motor_name}/command</command_topic>
      <velocity_topic>${motor_name}/velocity</velocity_topic>
      <encoder_topic>${motor_name}/encoder</encoder_topic>
      <current_topic>${motor_name}/current</current_topic>
      <supply_topic>${motor_name}/supply_voltage</supply_topic>
      <publish_encoder>false</publish_encoder>
      <publish_velocity>true</publish_velocity>
      <publish_current>true</publish_current>
      <publish_motor_joint_state>true</publish_motor_joint_state>
      <update_rate>100</update_rate>
      <motor_nominal_voltage>12</motor_nominal_voltage>
      <moment_of_inertia>0.00001</moment_of_inertia>
      <armature_damping_ratio>0</armature_damping_ratio>
      <electromotive_force_constant>0.1</electromotive_force_constant>
      <electric_resistance>1</electric_resistance>
      <electric_inductance>0.001</electric_inductance>
      <gear_ratio>1</gear_ratio>
      <encoder_ppr>40</encoder_ppr>
      <rosDebugLevel>Debug</rosDebugLevel>
    </plugin>
  </gazebo>

</xacro:macro>

</robot>
